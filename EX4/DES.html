<!DOCTYPE html>
<html>
<head>
    <title>DES Encryption</title>
</head>
<body>
    <h2>DES Encryption / Decryption</h2>

    <label>64-bit Plaintext:</label><br>
    <input type="text" id="plain"><br><br>

    <label>48-bit Key:</label><br>
    <input type="text" id="key"><br><br>

    <button onclick="encrypt()">Encrypt</button>
    <button onclick="decrypt()">Decrypt</button><br><br>

    <label>Result:</label><br>
    <textarea id="result" rows="5" cols="70"></textarea>

<script>
    // JS DES CODE (same as above)
    function xor(a, b) {
        let res = "";
        for (let i = 0; i < a.length; i++)
            res += (a[i] === b[i]) ? '0' : '1';
        return res;
    }

    function fFunction(right, key) {
        return xor(right, key.slice(0, right.length));
    }

    function encryptDES(plaintext, key) {
        let left = plaintext.slice(0, 32);
        let right = plaintext.slice(32);
        for (let i = 0; i < 16; i++) {
            let newLeft = right;
            let newRight = xor(left, fFunction(right, key));
            left = newLeft;
            right = newRight;
        }
        return right + left;
    }

    function decryptDES(ciphertext, key) {
        let left = ciphertext.slice(0, 32);
        let right = ciphertext.slice(32);
        for (let i = 0; i < 16; i++) {
            let newRight = left;
            let newLeft = xor(right, fFunction(left, key));
            right = newRight;
            left = newLeft;
        }
        return left + right;
    }

    function encrypt() {
        let p = document.getElementById("plain").value;
        let k = document.getElementById("key").value;
        document.getElementById("result").value = encryptDES(p, k);
    }

    function decrypt() {
        let c = document.getElementById("result").value;
        let k = document.getElementById("key").value;
        document.getElementById("result").value = decryptDES(c, k);
    }
</script>
</body>
</html>
